// Cloning
//we can also clone temporary table,transient table,schema, stages

SELECT * FROM PDB.PUBLIC.CUSTOMERS;

CREATE TABLE PDB.PUBLIC.CUSTOMERS_CLONE
CLONE PDB.PUBLIC.CUSTOMERS;


// Validate the data
SELECT * FROM PDB.PUBLIC.CUSTOMERS_CLONE;


// Update cloned table

UPDATE PDB.public.CUSTOMERS_CLONE
SET LAST_NAME = NULL;

SELECT * FROM PDB.PUBLIC.CUSTOMERS ;

SELECT * FROM PDB.PUBLIC.CUSTOMERS_CLONE;

//get data back so cloned from original table
CREATE or replace table PDB.PUBLIC.CUSTOMERS_CLONE
CLONE PDB.PUBLIC.CUSTOMERS;


// Cloning a temporary table is not possible
CREATE OR REPLACE TEMPORARY TABLE PDB.PUBLIC.TEMP_TABLE(
  id int);

insert into PDB.PUBLIC.TEMP_TABLE values(1);

CREATE OR REPLACE TEMPORARY TABLE PDB.PUBLIC.TABLE_COPY
CLONE PDB.PUBLIC.TEMP_TABLE;

SELECT * FROM PDB.PUBLIC.TABLE_COPY;

// Cloning Schema
CREATE OR REPLACE TRANSIENT SCHEMA PDB.COPIED_SCHEMA
CLONE PDB.PUBLIC;

SELECT * FROM COPIED_SCHEMA.CUSTOMERS


CREATE TRANSIENT SCHEMA PDB.EXTERNAL_STAGES_COPIED
CLONE MANAGEd_user.EXTERNAL_STAGES;



// Cloning Database
CREATE TRANSIENT DATABASE OUR_FIRST_DB_COPY
CLONE PDB;

DROP DATABASE OUR_FIRST_DB_COPY;
//DROP SCHEMA OUR_FIRST_DB_COPY.EXTERNAL_STAGES_COPIED;
//DROP SCHEMA OUR_FIRST_DB_COPY.COPIED_SCHEMA;
